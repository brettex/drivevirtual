<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">

    <title>Drive Virtual - Document Backup and Sharing</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <!--<link href="assets/font-awesome/css/font-awesome.css" rel="stylesheet" /> -->
    <!-- font awesome css -->
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" >
        
    <!-- Custom styles for this template -->
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="assets/css/style-responsive.css" rel="stylesheet">
    
    <!-- js placed at the end of the document so the pages load faster -->
    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/jquery-ui-1.9.2.custom.min.js"></script>
    <script src="assets/js/jquery.ui.touch-punch.min.js"></script>
    <script class="include" type="text/javascript" src="assets/js/jquery.dcjqaccordion.2.7.js"></script>
    <script src="assets/js/jquery.scrollTo.min.js"></script>
    <script src="assets/js/jquery.nicescroll.js" type="text/javascript"></script>


    <!--common script for all pages-->
    <script src="assets/js/common-scripts.js"></script>

    <!--script for this page-->
    
  <script>
  
  // See if they are logged in and an Admin
  checkLogin(true);
  
  </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

  <section id="container" >
      <!-- **********************************************************************************************************************************************************
      TOP BAR CONTENT & NOTIFICATIONS
      *********************************************************************************************************************************************************** -->
      <!--header start-->
      <header class="header black-bg">
              <div class="sidebar-toggle-box">
                  <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
              </div>
            <!--logo start-->
            <a href="index.html" class="logo"><b>Drive Virtual</b></a>
            <!--logo end-->
            <div class="nav notify-row" id="top_menu">
            </div>
            <div class="top-menu">
            	<ul class="nav pull-right top-menu">
                    <li><a class="logout" href="javascript:void(0);" id="logout">Logout</a></li>
            	</ul>
            </div>
        </header>
      <!--header end-->
      
      <!-- **********************************************************************************************************************************************************
      MAIN SIDEBAR MENU
      *********************************************************************************************************************************************************** -->
      <!--sidebar start-->
      <aside>
          <div id="sidebar"  class="nav-collapse">
              <!-- sidebar menu start-->
              <ul class="sidebar-menu" id="nav-accordion">
              
              	  <p class="centered"><a href="profile.html"><img src="assets/img/logo.png" width="180"></a></p>
              	  <h5 class="centered" id="company">Guest</h5>
              	  	
                  <li class="mt">
                      <a href="folder.html">
                          <i class="fa fa-folder"></i>
                          <span>Folders</span>
                      </a>
                  </li>
                  <li class="mt">
                      <a class="" href="profile.html">
                          <i class="fa fa-user"></i>
                          <span>Profile</span>
                      </a>
                  </li>
                  
              </ul>
              <!-- sidebar menu end-->
          </div>
      </aside>
      <!--sidebar end-->
      
      <!-- **********************************************************************************************************************************************************
      MAIN CONTENT
      *********************************************************************************************************************************************************** -->
      <!--main content start-->
      <section id="main-content">
          <section class="wrapper site-min-height">
          	<h3><i class="fa fa-angle-right"></i> Create New Account</h3>
<!-- BASIC FORM ELELEMNTS -->
          	<div class="row mt">
          		<div class="col-lg-12">
                  <div class="form-panel">
                  	  <h4 class="mb"><i class="fa fa-angle-right"></i> All Required Fields</h4>
                      <div class="alert alert-danger" id="login-msg"></div>
                      <form class="form-horizontal style-form" method="get">
                          <div class="form-group">
                              <label class="col-sm-2 col-sm-2 control-label" for="company1">Company Name</label>
                              <div class="col-sm-10">
                                  <input type="text" class="form-control" id="company1" required>
                              </div>
                          </div>
                          <div class="form-group">
                              <label class="col-sm-2 col-sm-2 control-label" for="email">Email Address</label>
                              <div class="col-sm-10">
                                  <input type="text" class="form-control" id="email" required>
                              </div>
                          </div>
                          <div class="form-group">
                              <label class="col-sm-2 col-sm-2 control-label" for="username">FTP Username</label>
                              <div class="col-sm-10">
                                  <input type="text" class="form-control" id="username" required>
                              </div>
                          </div>
                          <div class="form-group">
                              <label class="col-sm-2 col-sm-2 control-label" for="host">FTP Host</label>
                              <div class="col-sm-10">
                                  <input type="text" class="form-control" id="host" required>
                              </div>
                          </div>
                          <div class="form-group">
                              <label class="col-sm-2 col-sm-2 control-label" for="password">FTP Password</label>
                              <div class="col-sm-10">
                                  <input type="text" class="form-control" id="password" required>
                              </div>
                          </div>
                          <div class="form-group">
                          	<label class="col-sm-2 col-sm-2 control-label" for="port">Port</label>
                            <div class="col-sm-10">
                                <div class="radio">
                                  <label>
                                    <input type="radio" name="port" id="FTP" value="21" checked>
                                   Regular FTP (21)
                                  </label>
                                </div>
                                <div class="radio">
                                  <label>
                                    <input type="radio" name="port" id="SFTP" value="22">
                                    Secure FTP (22)
                                  </label>
                                </div>
                            </div>
                          </div>
                          <button class="btn btn-theme" type="button" id="test">Test</button>
                          <button class="btn btn-theme" type="button" id="register" disabled="">Save</button>
                      </form>
                  </div>
          		</div><!-- col-lg-12-->      	
          	</div><!-- /row -->
			
		</section><!-- wrapper -->
      </section><!-- /MAIN CONTENT -->

      <!--main content end-->
      <!--footer start-->
      <footer class="site-footer">
          <div class="text-center">
              2015 Drive Virtual &copy
              <a href="blank.html#" class="go-top">
                  <i class="fa fa-angle-up"></i>
              </a>
          </div>
      </footer>
      <!--footer end-->
  </section>

<script>
  
$(document).ready(function(){
	
	populateCompanyName();
	
	$('#test').on('click', function(e){
		e.preventDefault();
		var host = $('#host').val();
		var user = $('#username').val();
		var password = $('#password').val();
		var port = $('input[name="port"]:checked').val();
		
		checkFTP(host, user, password, port);
	});
	
	$('#register').on('click', function(e){
		e.preventDefault();
		
		var check = checkFields();
		if(check == 0){
			var company = $('#company1').val();
			var host = $('#host').val();
			var user = $('#username').val();
			var password = $('#password').val();
			var email = $('#email').val();
			var port = $('input[name="port"]:checked').val();
			
			addNew(host, user, password, email, company, port);
	}
		
	});
});

/** Function to Register a user
	
	@variable - string, company
	@variable - string, host
	@variable - string, user
	@variable - string, password
	@variable - string, email
	
**/
function addNew(host, user, pass, email, company, port){

	var html = 'Sorry, could not register user at this time.';
	
  $.ajax({
	url: 'assets/includes/userFunctions.php?action=addNew&Host='+ host + '&FTPUser=' + user + '&email=' + email + '&company=' + company + '&port=' +port,
	dataType: 'jsonp',
	jsonp: 'jsoncallback',
	type:'POST',
	data:{'password': pass },
	timeout: 15000,
	error: function(){

		$('.alert').addClass('alert-danger').html(html);
	},
	cache: false,
	success: function(data, status){
		if(data.msg){
			html = 'User Succesfully Registered!';
			$('.alert').removeClass('alert-danger').html(html);
			$('#register').removeAttr('disabled');
		} else {
			$('.alert').addClass('alert-danger').html(html);
		}
	}
	
  });
}

function checkFields(){
	
		var error = 0;
		var val ='';
		
		$('input[type="text"]').each( function(){
			
			val = $(this).val();
			if(val.length == 0){
				error = 1;
				$(this).parents('.form-group').addClass('has-error');
			} else {
				$(this).parents('.form-group').removeClass('has-error');	
			}
		});
		
		return error;
}
</script>

  </body>
</html>
